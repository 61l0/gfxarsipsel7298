<?phpclass print_word_tree extends CI_Model {    function __construct (){        parent::__construct();	}		function index($params=false){	    require_once(CLASSES_PATH.'PHPWord.php');	    $data=$params->data;//	    dump($params->data);	    $colModel=$params->colModel;	    $word=$params->word;	    $expanded = $params->ExpandColumn;	    $PHPWord = new PHPWord();		$document = $PHPWord->createSection();        $styleTable = array(                'borderColor'=>'000',			    'borderSize'=>6,			    'cellMargin'=>20			    );        $styleFirstRow = array('bgColor'=>'000');        $PHPWord->addTableStyle('myTable', $styleTable, $styleFirstRow);        $table = $document->addTable('myTable');        $table->addRow('10');        foreach($colModel as $key=>$rowModel):           if(@$rowModel['editable'] == true || @$rowModel['viewrecords'] == true):                if(@$word['show_col']){                    if(@$word['show_col'][$key]){                        $table->addCell('200')->addText(@$rowModel['label']);                    }                }else{                    $table->addCell('200')->addText(@$rowModel['label']);                }            endif;        endforeach;        foreach(@$data['rows'] as $key=>$row):            $table->addRow('10');            foreach($colModel as $key2=>$rowModel):                if($expanded == $key2){                    if($row->n_level != 1){                        $space = str_repeat('   ',$row->n_level);                                        }else{                        $space = "";                    }                }else{                    $space = "";                }                if(@$rowModel['editable'] == true || @$rowModel['viewrecords'] == true):                    if(@$word['show_col']){                        if(@$word['show_col'][$key2]){                            $table->addCell('200')->addText($space.@$row->$key2);                        }                    }else{                        $table->addCell('200')->addText($space.@$row->$key2);                    }                endif;            endforeach;        endforeach;        $nama_file = 'sample_'.date('dmYHis');		$objWriter = PHPWord_IOFactory::createWriter($PHPWord, 'Word2007');        header('Content-Type: application/vnd.ms-word');        header("Content-Disposition: attachment;filename=\"$nama_file.docx\"");        header('Cache-Control: max-age=0');        $objWriter->save("php://output");        header("location:".$nama_file);	}}?>