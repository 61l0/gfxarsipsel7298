<?phpclass print_excel extends CI_Model {    function __construct (){        parent::__construct();	}		function index($params=false){	    $data=$params->data;	    $colModel=$params->colModel;	    $excel=$params->excel;	    $this->load->library('Myexcel');        $start_col = $excel['start_col'];        $start_row = $excel['start_row'];        if(@$excel['show_col']){            foreach($excel['show_col'] as $key=>$row):                            $this->myexcel->getActiveSheet()->getCell(@$excel['start_col'].@$excel['start_row'])->setValue(@$colModel[$key]['label']);                $this->myexcel->getActiveSheet()->getStyle(@$excel['start_col'].@$excel['start_row'])->applyFromArray($excel['border_head']);                $row_data = $excel['start_row'] + 1;                foreach(@$data['rows'] as $rows):                    $this->myexcel->getActiveSheet()->getCell(@$excel['start_col'].$row_data)->setValue($rows->$key);                    $this->myexcel->getActiveSheet()->getStyle(@$excel['start_col'].$row_data)->applyFromArray($excel['border_all']);                    $row_data++;                endforeach;                $end_col = $excel['start_col'];                $end_row = $excel['start_row'];                @$excel['start_col']++;            endforeach;        }else{            foreach($colModel as $key=>$rowModel):                if(@$rowModel['editable'] == true || @$rowModel['viewrecords'] == true):                    $this->myexcel->getActiveSheet()->getCell(@$excel['start_col'].@$excel['start_row'])->setValue(@$colModel[$key]['label']);                    $this->myexcel->getActiveSheet()->getStyle(@$excel['start_col'].@$excel['start_row'])->applyFromArray($excel['border_head']);                    $row_data = $excel['start_row'] + 1;                    foreach(@$data['rows'] as $row):                        $this->myexcel->getActiveSheet()->getCell(@$excel['start_col'].$row_data)->setValue($row->$key);                        $this->myexcel->getActiveSheet()->getStyle(@$excel['start_col'].$row_data)->applyFromArray($excel['border_all']);                        $row_data++;                    endforeach;                    $end_col = $excel['start_col'];                    $end_row = $excel['start_row'];                    @$excel['start_col']++;                endif;	        endforeach;                }        if(@$excel){            foreach(@$excel as $key=>$row):                if($key=='header'):                    $this->myexcel->writeRow($row['start_col'].$row['start_row'].":".$end_col.$row['start_row'],$row['caption']);                    $this->myexcel->getActiveSheet()->getStyle($row['start_col'].$row['start_row'].":".$end_col.$row['start_row'])->applyFromArray($excel['style_header']);                endif;                if($key=='footer'):                    $this->myexcel->writeRow($start_col.($row_data+1).":".$end_col.($row_data+1),$row['caption']);                    $this->myexcel->getActiveSheet()->getStyle($start_col.($row_data+1).":".$end_col.($row_data+1))->applyFromArray($excel['style_footer']);                endif;            endforeach;        }		$this->myexcel->download();		}}?>