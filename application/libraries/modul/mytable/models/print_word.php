<?phpclass print_word extends CI_Model {    function __construct (){        parent::__construct();	}		function index($params=false){	    $data=$params->data;	    $colModel=$params->colModel;	    $word=$params->word;//	    dump($colModel);	    require_once(CLASSES_PATH.'PHPWord.php');//	    dump(CLASSES_PATH.'PHPWord.php');	    $PHPWord = new PHPWord();	    $documentStyle = array('orientation' => null,			    'marginLeft' => 900,			    'marginRight' => 900,			    'marginTop' => 900,			    'marginBottom' => 900);		$headerStyle = array('color'=>'006699', 'size'=>20, 'bold'=>true);		$document = $PHPWord->createSection($documentStyle);		$header = $document->createHeader();        $footer = $document->createFooter();                $header->addPreserveText('Test header',$headerStyle);        $footer->addPreserveText('Page {PAGE} of {NUMPAGES}.');        $document->addTextBreak(1);        $styleTable = array(                'borderColor'=>'000',			    'borderSize'=>6,			    'cellMargin'=>20			    );        $styleFirstRow = array('bgColor'=>'000');        $PHPWord->addTableStyle('myTable', $styleTable, $styleFirstRow);        $table = $document->addTable('myTable');        $table->addRow('10');        foreach($colModel as $key=>$rowModel):           if(@$rowModel['editable'] == true || @$rowModel['viewrecords'] == true):                if(@$word['show_col']){                    if(@$word['show_col'][$key]){                        $table->addCell('200')->addText(@$rowModel['label']);                    }                }else{                    $table->addCell('200')->addText(@$rowModel['label']);                }            endif;        endforeach;//        dump($data);        foreach(@$data as $key=>$row):            $table->addRow('10');            foreach($colModel as $key2=>$rowModel):                if(@$rowModel['editable'] == true || @$rowModel['viewrecords'] == true):                    if(@$word['show_col']){                        if(@$word['show_col'][$key2]){                            $table->addCell('200')->addText(@$row->$key2);                        }                    }else{                        $table->addCell('200')->addText(@$row->$key2);                    }//                    dump($row->$key2);//                    $table->addCell('200')->addText(@$row->$key2);                endif;            endforeach;        endforeach;        $nama_file = 'sample_'.date('dmYHis');		$objWriter = PHPWord_IOFactory::createWriter($PHPWord, 'Word2007');        header('Content-Type: application/vnd.ms-word');        header("Content-Disposition: attachment;filename=\"$nama_file.docx\"");        header('Cache-Control: max-age=0');        $objWriter->save("php://output");        header("location:".$nama_file);	}}?>